<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>フリーランサーとして生きる道</title>
  
  <subtitle>令和元年の目標はNode.jsを極めること！</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://lancers.work/"/>
  <updated>2019-04-07T10:22:39.000Z</updated>
  <id>https://lancers.work/</id>
  
  <author>
    <name>bulma</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hexo-&gt;GitHub-&gt;Netlifyで静的サイトを公開する方法をわかりやすく解説</title>
    <link href="https://lancers.work/hexo-github-netlify-deploy/"/>
    <id>https://lancers.work/hexo-github-netlify-deploy/</id>
    <published>2019-04-06T22:59:00.000Z</published>
    <updated>2019-04-07T10:22:39.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/hexo-github-netlify-deploy.jpg" alt></p><p>これまで社内サーバーにKUSANAGI仮想マシンを置いて、その中でNode.jsの開発、このブログの執筆を行い、公開していました。</p><p>開発環境は快適で、ブログの公開もデプロイ？SSL？なんて考えず、KUSANAGI配下で簡単に行っていました。</p><a href="https://lancers.work/hexo-on-kusanagi/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/hexo-on-kusanagi.jpg"></div><div class="descriptions"><div class="og-title">KUSANAGIのLAMP環境にHexoを構築</div><div class="og-description">まだHexoでブログを書き始めたばかりで、正直Node.jsでのWEBアプリ開発はまだ本格的に始めていません。 HexoはNode.jsをほ…</div></div></div></a><p>しかし、如何せん弱小回線のため、このブログのGoogleの<a href="https://developers.google.com/speed/pagespeed/insights/" target="_blank" rel="noopener">PageSpeed Insights</a>では<strong>遅い！</strong>とお叱りを受けていました（泣）</p><p>そこで高機能でパフォーマンスが優れていて、Hexoユーザー御用達の無料ホスティングサービス<a href="https://www.netlify.com/" target="_blank" rel="noopener">Netlify</a>に移行することにしました。</p><p>結果から言いますとPageSpeed Insightsのスコアは激的に改善されました。</p><p>引っ越しにあたりましていくつかのサイトを参考にさせてもらいましたが、少々ややこしく書かれていたり、もっと単純かつ簡単にNetlifyにデプロイ（配置）できましたので、そのあたりをまとめておきたいと思います。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#前段">前段</a></li><li><a href="#hexoの設定">Hexoの設定</a><ul><li><a href="#_configymlの設定">_config.ymlの設定</a></li><li><a href="#プラグインのインストール">プラグインのインストール</a></li></ul></li><li><a href="#githubへのデプロイ">GitHubへのデプロイ</a></li><li><a href="#netlifyにデプロイ">Netlifyにデプロイ</a></li><li><a href="#https化">HTTPS化</a></li><li><a href="#まとめ">まとめ</a></li></ul><!-- tocstop --></div><h2><span id="前段">前段</span></h2><p>この記事を読んでいる方は、</p><ul><li>既にHexoでブログを書いている</li><li>GitHubのアカウントを既に持っている</li></ul><p>という方を対象にしています。</p><p>Node.jsやHexoのインストール方法などは、当ブログの記事や皆さんの記事を参考にしてください。</p><a href="https://lancers.work/hexo-nodejs-blog/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/hexo-start-nodejs.jpg"></div><div class="descriptions"><div class="og-title">Hexo（node.js）で静的ブログを構築してみる</div><div class="og-description">もともとは、超高速WordPress仮想マシン「KUSANAGI」でWEBアプリを量産しようということで、KUSANAGIでブログを書いてい…</div></div></div></a><h2><span id="hexoの設定">Hexoの設定</span></h2><h3><span id="_configymlの設定">_config.ymlの設定</span></h3><figure class="highlight bash"><figcaption><span>_config.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line">deploy:</span><br><span class="line">  <span class="built_in">type</span>: git</span><br><span class="line">  repo: https://github.com/your-git-account/your-repository.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>ブログ本体（Themes内ではなく）の<code>_config.yml</code>の<code># Deployment</code>の箇所に上記のように記述します。</p><p>予め、リポジトリ（空でOK）を作成しておき、gitのURLをrepo欄に記述します。<br>（私はprivateなリポジトリを作成しました。）</p><p>同じ<code>_config.yml</code>にURLを記述する箇所がありますが、ここは、<strong>GitHub Pagesにブログを公開するわけではない</strong>ので、GitHub PagesのURLを記述せず、独自ドメインや今まで入力してあった内容のままで大丈夫です。</p><figure class="highlight bash"><figcaption><span>このブログの例</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></span><br><span class="line">url: https://lancers.work</span><br><span class="line">root: /</span><br><span class="line">permalink: :title/</span><br><span class="line">permalink_defaults:</span><br></pre></td></tr></table></figure><h3><span id="プラグインのインストール">プラグインのインストール</span></h3><figure class="highlight bash"><figcaption><span>git デプロイプラグイン</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -S hexo-deployer-git</span><br></pre></td></tr></table></figure><p>hexoブログの設定はここまでです。</p><h2><span id="githubへのデプロイ">GitHubへのデプロイ</span></h2><p>早速Netlifyに展開してきましょう。</p><p>まずは、静的HTMLを生成し、同時にHTMLソースをGitHubへデプロイします。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d -g</span><br></pre></td></tr></table></figure><p>このコマンドだけで完了しますので、予め作成しておいたGitHubのリポジトリを見てみてください。</p><p>生成されたHTMLソースが登録されていると思います。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><h2><span id="netlifyにデプロイ">Netlifyにデプロイ</span></h2><p><a href="https://www.netlify.com/" target="_blank" rel="noopener">Netlify</a>にGitHubアカウントでログインします。</p><p><img src="/images/netlify-1.jpg" alt></p><p><strong>New site from Git</strong>ボタンを押します。</p><p><img src="/images/netlify-2.jpg" alt></p><p><strong>GitHub</strong>ボタンを押します。</p><p><img src="/images/netlify-3.jpg" alt></p><p>先程作ったGitHubのリポジトリを選択します。<br>（この画面に辿り着く前に、どのリポジトリを登録するかの画面があると思いますが私はallを選択しました。キャプチャ漏れすいません。）</p><p><img src="/images/netlify-4.jpg" alt></p><p><strong>Deploy site</strong>ボタンを押してNetlifyにデプロイします。</p><p>ポイントは<code>Build command</code>も<code>Publish directory</code>も未入力にすることです。</p><p><img src="/images/netlify-5.jpg" alt></p><p>無事デプロイされると<code>https://hogehoge-hoge-e38e39.netlify.com/</code>のような一時的なURLが示され、ブログが表示されます。</p><p>独自ドメインを設定される場合は、<strong>Domain management</strong>メニューからドメインを登録して、DNSサーバーにNetlifyが示したAレコードを設定します。</p><h2><span id="https化">HTTPS化</span></h2><p><img src="/images/netlify-6.jpg" alt></p><p>この記事の投稿時点ではまだDNSが浸透していないので、HTTPS化されていないと思いますが、上記画像のボタンを押すだけでSSL化が完了します。</p><h2><span id="まとめ">まとめ</span></h2><p>上記までの作業で後は、</p><p>1 Hexoでブログを書く</p><p>2 <code>hexo d -g</code>コマンドを実行する</p><p>の繰り返しでGitHubを意識せずNetlifyに自動的にデプロイされます。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/hexo-github-netlify-deploy.jpg&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;これまで社内サーバーにKUSANAGI仮想マシンを置いて、その中でNode.jsの開発、このブログの執筆を行い、公開していました。&lt;/p&gt;
&lt;p&gt;開発
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
    
      <category term="Node.js" scheme="https://lancers.work/tags/Node-js/"/>
    
      <category term="Hexo" scheme="https://lancers.work/tags/Hexo/"/>
    
      <category term="GitHub" scheme="https://lancers.work/tags/GitHub/"/>
    
      <category term="Netlify" scheme="https://lancers.work/tags/Netlify/"/>
    
  </entry>
  
  <entry>
    <title>ナンバーズ3アプリ ～ Node.jsベース ～</title>
    <link href="https://lancers.work/numbers3/"/>
    <id>https://lancers.work/numbers3/</id>
    <published>2019-04-05T05:39:00.000Z</published>
    <updated>2019-04-07T11:30:15.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://lancers.work/numbers4/">ナンバーズ4はこちら</a></p><h2><span id="ナンバーズ3-過去10回の当選数字">ナンバーズ3 過去<span class="selected-tit">10</span>回の当選数字</span></h2><p>集計回数<select id="tit"></select></p><table id="win-result"></table><h2><span id="ナンバーズ3-過去10回の当選数字出現回数">ナンバーズ3 過去<span class="selected-tit">10</span>回の当選数字出現回数</span></h2><table id="win-count"></table><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#ナンバーズアプリについて">ナンバーズアプリについて</a><ul><li><a href="#ナンバーズアプリの使い方">ナンバーズアプリの使い方</a></li><li><a href="#ナンバーズ予想-実験方法">ナンバーズ予想 実験方法</a></li><li><a href="#このアプリを支えているnodejs製webアプリ">このアプリを支えているNode.js製WEBアプリ</a></li></ul></li></ul><!-- tocstop --></div><h2><span id="ナンバーズアプリについて">ナンバーズアプリについて</span></h2><h3><span id="ナンバーズアプリの使い方">ナンバーズアプリの使い方</span></h3><p>直近回から過去30回までの当選番号、出現回数を調べることができます</p><p>集計回数を絞り込むと下段の「当選数字出現回数」も自動的に集計し直されます。</p><h3><span id="ナンバーズ予想-実験方法">ナンバーズ予想 実験方法</span></h3><p>某テレビ番組で「月の最初の2週間の当選数字」に出現していない数字を中心に残り2週間ナンバーズを買い続けるという必勝法が紹介されていました。<br>※テレビ放映では当選確率100％と言っていて、本当に当選していました。（購入口数もそれなりに必要だったみたいですが・・・）</p><p>本アプリでは、この放映内容を元に直近2週間分（10回分）の当選数字を集計して、どの数字が出ていないかチェックすることができます。</p><p>具体的な購入数字の組み合わせはこのアプリでは提供されませんので、このアプリの先からはあなたの運におまかせします！</p><p>ナンバーズは偏りはあるものの所詮確率論と考えていますので、最終的にはすべての組み合わせ・数字が等しく出現するハズとの考え方を尊重しています。</p><h3><span id="このアプリを支えているnodejs製webアプリ">このアプリを支えているNode.js製WEBアプリ</span></h3><p>本アプリで使用しているナンバーズの当選番号データは、Node.jsで作成したWEBアプリでスクレイピングにより取得しています。<br>（スクレイピンは1日1回行っています。スクレイピングをする際は対象サイトに迷惑をかけないように行いましょう。）</p><p>Node.jsアプリのエッセンスは下記記事に書いています。</p><a href="https://lancers.work/numbers-1/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/numbers-1.jpg"></div><div class="descriptions"><div class="og-title">Node.jsによるナンバーズアプリ ～ 1.スクレイピング編 ～</div><div class="og-description">※Node.jsアプリ作成の共有コーナーです。※Node.jsアプリ作成にはExpressを使用しています。 今回はナンバーズ（NUMBER…</div></div></div></a><a href="https://lancers.work/numbers-2/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/numbers-2.jpg"></div><div class="descriptions"><div class="og-title">Node.jsによるナンバーズアプリ ～ 2.配列のソート・jsonファイル保存編 ～</div><div class="og-description">※Node.jsアプリ作成の共有コーナーです。※Node.jsアプリ作成にはExpressを使用しています。 今回はナンバーズ（NUMBER…</div></div></div></a><p><a href="https://lancers.work/numbers4/">ナンバーズ4はこちら</a></p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><style>#tit {font-size: large;} #win-result th, #win-result td {text-align: center; width: 25%;}</style><script>function createTable(c) {  var t = '<tr><th>回分</th><th>回別</th><th>抽選日</th><th>当選数字</th></tr>';  var ca = [];  $.getJSON('../../json/numbers3.json', function(d) {    for(var i=0; i<c; i++) {      var num = Number(i) + 1;      t += '<tr><td>'+num+'</td><td>'+d[i].tit+'</td><td>'+d[i].date+'</td><td>'+d[i].win+'</td></tr>';      ca.push(strToArray(d[i].win));    }    $('#win-result').append(t);    t = makeCountTable(ca);    $('#win-count').append(t);  });  $('.selected-tit').text(c);}function makeCountTable(c) {  var ct = countNumber(c);  ct.sort(function(a,b) {    if(a.count < b.count) return -1;    if(a.count > b.count) return 1;    return 0;  });  var t = '<tr><th width="50%">当選数字（出現回数少ない順）</th>';  ct.forEach(function(d) {    t += '<th width="5%">'+d.num+'</th>';  });  t += '</tr><tr><td width="50%">出現回数</td>';  ct.forEach(function(d) {    t += '<td width="5%">'+d.count+'</td>';  });  t += '<tr>';  return t;}function strToArray(s) {  var s1 = s.split('');  var a = [];  s1.forEach(function(d) {    a.push(d);  });  return a;}function countNumber(a) {  var c = [0,0,0,0,0,0,0,0,0,0];  a.forEach(function(d1) {    d1.forEach(function(d2) {      c[d2]++;    });  });  var r = [];  for(var i=0; i<10; i++) {    r.push({"num":i, "count":c[i]})  }  return r;}$(function() {  $('#tit').on('change', function() {    $('#win-result tr').remove();    $('#win-count tr').remove();    var t = $('#tit').val();    createTable(t);  });});$(function() {  var base = 10;  for(var i=1; i<31; i++) {    if(i == base) {      var s = ' selected';    } else {      var s = '';    }    $('#tit').append('<option value="'+i+'"'+s+'>過去'+i+'回分</option>');  }  createTable(base);});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://lancers.work/numbers4/&quot;&gt;ナンバーズ4はこちら&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;span id=&quot;ナンバーズ3-過去10回の当選数字&quot;&gt;ナンバーズ3 過去&lt;span class=&quot;selected-tit&quot;&gt;10&lt;/span
      
    
    </summary>
    
      <category term="アプリ" scheme="https://lancers.work/categories/%E3%82%A2%E3%83%97%E3%83%AA/"/>
    
    
      <category term="Node.js" scheme="https://lancers.work/tags/Node-js/"/>
    
      <category term="Express" scheme="https://lancers.work/tags/Express/"/>
    
      <category term="jQuery" scheme="https://lancers.work/tags/jQuery/"/>
    
  </entry>
  
  <entry>
    <title>ナンバーズ4アプリ ～ Node.jsベース ～</title>
    <link href="https://lancers.work/numbers4/"/>
    <id>https://lancers.work/numbers4/</id>
    <published>2019-04-05T05:39:00.000Z</published>
    <updated>2019-04-07T11:31:15.000Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://lancers.work/numbers3/">ナンバーズ3はこちら</a></p><h2><span id="ナンバーズ4-過去10回の当選数字">ナンバーズ4 過去<span class="selected-tit">10</span>回の当選数字</span></h2><p>集計回数<select id="tit"></select></p><table id="win-result"></table><h2><span id="ナンバーズ4-過去10回の当選数字出現回数">ナンバーズ4 過去<span class="selected-tit">10</span>回の当選数字出現回数</span></h2><table id="win-count"></table><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#ナンバーズアプリについて">ナンバーズアプリについて</a><ul><li><a href="#ナンバーズアプリの使い方">ナンバーズアプリの使い方</a></li><li><a href="#ナンバーズ予想-実験方法">ナンバーズ予想 実験方法</a></li><li><a href="#このアプリを支えているnodejs製webアプリ">このアプリを支えているNode.js製WEBアプリ</a></li></ul></li></ul><!-- tocstop --></div><h2><span id="ナンバーズアプリについて">ナンバーズアプリについて</span></h2><h3><span id="ナンバーズアプリの使い方">ナンバーズアプリの使い方</span></h3><p>直近回から過去30回までの当選番号、出現回数を調べることができます</p><p>集計回数を絞り込むと下段の「当選数字出現回数」も自動的に集計し直されます。</p><h3><span id="ナンバーズ予想-実験方法">ナンバーズ予想 実験方法</span></h3><p>某テレビ番組で「月の最初の2週間の当選数字」に出現していない数字を中心に残り2週間ナンバーズを買い続けるという必勝法が紹介されていました。<br>※テレビ放映では当選確率100％と言っていて、本当に当選していました。（購入口数もそれなりに必要だったみたいですが・・・）</p><p>本アプリでは、この放映内容を元に直近2週間分（10回分）の当選数字を集計して、どの数字が出ていないかチェックすることができます。</p><p>具体的な購入数字の組み合わせはこのアプリでは提供されませんので、このアプリの先からはあなたの運におまかせします！</p><p>ナンバーズは偏りはあるものの所詮確率論と考えていますので、最終的にはすべての組み合わせ・数字が等しく出現するハズとの考え方を尊重しています。</p><h3><span id="このアプリを支えているnodejs製webアプリ">このアプリを支えているNode.js製WEBアプリ</span></h3><p>本アプリで使用しているナンバーズの当選番号データは、Node.jsで作成したWEBアプリでスクレイピングにより取得しています。<br>（スクレイピンは1日1回行っています。スクレイピングをする際は対象サイトに迷惑をかけないように行いましょう。）</p><p>Node.jsアプリのエッセンスは下記記事に書いています。</p><a href="https://lancers.work/numbers-1/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/numbers-1.jpg"></div><div class="descriptions"><div class="og-title">Node.jsによるナンバーズアプリ ～ 1.スクレイピング編 ～</div><div class="og-description">※Node.jsアプリ作成の共有コーナーです。※Node.jsアプリ作成にはExpressを使用しています。 今回はナンバーズ（NUMBER…</div></div></div></a><a href="https://lancers.work/numbers-2/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/numbers-2.jpg"></div><div class="descriptions"><div class="og-title">Node.jsによるナンバーズアプリ ～ 2.配列のソート・jsonファイル保存編 ～</div><div class="og-description">※Node.jsアプリ作成の共有コーナーです。※Node.jsアプリ作成にはExpressを使用しています。 今回はナンバーズ（NUMBER…</div></div></div></a><p><a href="https://lancers.work/numbers3/">ナンバーズ3はこちら</a></p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><style>#tit {font-size: large;} #win-result th, #win-result td {text-align: center; width: 25%;}</style><script>function createTable(c) {  var t = '<tr><th>回分</th><th>回別</th><th>抽選日</th><th>当選数字</th></tr>';  var ca = [];  $.getJSON('../../json/numbers4.json', function(d) {    for(var i=0; i<c; i++) {      var num = Number(i) + 1;      t += '<tr><td>'+num+'</td><td>'+d[i].tit+'</td><td>'+d[i].date+'</td><td>'+d[i].win+'</td></tr>';      ca.push(strToArray(d[i].win));    }    $('#win-result').append(t);    t = makeCountTable(ca);    $('#win-count').append(t);  });  $('.selected-tit').text(c);}function makeCountTable(c) {  var ct = countNumber(c);  ct.sort(function(a,b) {    if(a.count < b.count) return -1;    if(a.count > b.count) return 1;    return 0;  });  var t = '<tr><th width="50%">当選数字（出現回数少ない順）</th>';  ct.forEach(function(d) {    t += '<th width="5%">'+d.num+'</th>';  });  t += '</tr><tr><td width="50%">出現回数</td>';  ct.forEach(function(d) {    t += '<td width="5%">'+d.count+'</td>';  });  t += '<tr>';  return t;}function strToArray(s) {  var s1 = s.split('');  var a = [];  s1.forEach(function(d) {    a.push(d);  });  return a;}function countNumber(a) {  var c = [0,0,0,0,0,0,0,0,0,0];  a.forEach(function(d1) {    d1.forEach(function(d2) {      c[d2]++;    });  });  var r = [];  for(var i=0; i<10; i++) {    r.push({"num":i, "count":c[i]})  }  return r;}$(function() {  $('#tit').on('change', function() {    $('#win-result tr').remove();    $('#win-count tr').remove();    var t = $('#tit').val();    createTable(t);  });});$(function() {  var base = 10;  for(var i=1; i<31; i++) {    if(i == base) {      var s = ' selected';    } else {      var s = '';    }    $('#tit').append('<option value="'+i+'"'+s+'>過去'+i+'回分</option>');  }  createTable(base);});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://lancers.work/numbers3/&quot;&gt;ナンバーズ3はこちら&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;&lt;span id=&quot;ナンバーズ4-過去10回の当選数字&quot;&gt;ナンバーズ4 過去&lt;span class=&quot;selected-tit&quot;&gt;10&lt;/span
      
    
    </summary>
    
      <category term="アプリ" scheme="https://lancers.work/categories/%E3%82%A2%E3%83%97%E3%83%AA/"/>
    
    
      <category term="Node.js" scheme="https://lancers.work/tags/Node-js/"/>
    
      <category term="Express" scheme="https://lancers.work/tags/Express/"/>
    
      <category term="jQuery" scheme="https://lancers.work/tags/jQuery/"/>
    
  </entry>
  
  <entry>
    <title>VMware ESXi「No Network Adapters」エラー時の対処法</title>
    <link href="https://lancers.work/vmware-esxi65-realtek-nic/"/>
    <id>https://lancers.work/vmware-esxi65-realtek-nic/</id>
    <published>2019-04-04T02:10:00.000Z</published>
    <updated>2019-04-07T10:21:31.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/vmware-esxi65-realtek-nic.jpg" alt></p><p>ESXiはINTEL NIC以外のネットワークアダプタを認識してくれない？！</p><p>使わないパソコンが3台あって、VMware vSphere Hypervisor ESXiを入れたところ、見事に3台とも「No Network Adapters」のグレー画面（キャプチャ撮り忘れた）が現れてインストールできず。</p><p>どうやらINTEL NIC以外のネットワークアダプタは認識しないようで、確かにINTEL製ではなかった。。。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#esxiのカスタムisoを作る">ESXiのカスタムISOを作る</a></li><li><a href="#esxi-customizer-ps-v260ps1はデジタル署名されていません">ESXi-Customizer-PS-v2.6.0.ps1はデジタル署名されていません。</a></li></ul><!-- tocstop --></div><h2><span id="esxiのカスタムisoを作る">ESXiのカスタムISOを作る</span></h2><p>先人の方々の教え通り、</p><ul><li>vSphere PowerCLI <a href="https://my.vmware.com/jp/group/vmware/details?productId=491&amp;downloadGroup=PCLI630R1" target="_blank" rel="noopener">VMware-PowerCLI-6.3.0-3737840.exe</a></li><li>ESXi-Customizer-PS <a href="https://www.v-front.de/p/esxi-customizer-ps.html" target="_blank" rel="noopener">ESXi-Customizer-PS-v2.6.0.ps1</a></li><li>Realtek NIC on vSphere 6 <a href="http://www.vdicloud.nl/2015/02/07/realtek-nic-on-vsphere-6/" target="_blank" rel="noopener">net51-drivers-1.0.0-1vft.510.0.0.799733.x86_64.vib</a></li></ul><p>をダウンロードして、CustomizerとRealtek NICドライバをC\:に置きます。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\ESXi-Customizer-PS-v2.6.0.ps1 -v65 -pkgDir C:\</span><br></pre></td></tr></table></figure><p>このようにコマンド実行すると、Realtek NIC入のESXi6.5のISOファイルが出来上がります。</p><p>ここまでの流れで、コマンド実行前にポリシー実行の設定を変えたりするのですが、一つつまずいた点がありました。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><h2><span id="esxi-customizer-ps-v260ps1はデジタル署名されていません">ESXi-Customizer-PS-v2.6.0.ps1はデジタル署名されていません。</span></h2><p><img src="/images/vmware-esxi65-realtek-nic-1.jpg" alt></p><p>ポリシー実行を変更しても、「ESXi-Customizer-PS-v2.6.0.ps1はデジタル署名されていません。」という冷たいお言葉が帰ってきました。</p><p>デジタル署名ってどうするの？</p><p>答えは簡単でした。</p><p><img src="/images/vmware-esxi65-realtek-nic-2.jpg" alt></p><p>ESXi-Customizer-PS-v2.6.0.ps1のプロパティを開いて、赤枠の「許可する」にチェックを入れると上記のエラーメッセージは出なくなり、無事にISOファイルが作成できます。</p><p>ここだけの話、最初欲張って、Realtek NIC入りESXi6.7を下記コマンドで作ってみたのですが、</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\ESXi-Customizer-PS-v2.6.0.ps1 -v67 -pkgDir C:\</span><br></pre></td></tr></table></figure><p>警告の嵐で作成できませんでした。</p><p>ESXi6.7バージョンがほしい方はこちらのサイトが参考になりますので、お試しください。</p><a href="https://tech-mmmm.blogspot.com/2018/05/realteknicesxi-67.html" class="link-preview" target="_blank" rel="nofollow"><div class="link-area"><div class="og-image"><img src="https://4.bp.blogspot.com/-Y-xjQu6JajQ/Wwie09q0KRI/AAAAAAAAUXM/RBA70tFxCtQRi0yk-ZW-Q1DSNGJVnd1BwCLcBGAs/w1200-h630-p-k-no-nu/004.png"></div><div class="descriptions"><div class="og-title">RealtekのNICのドライバーを組み込んだESXi 6.7のカスタムイメージを作成する</div><div class="og-description">インフラエンジニアの技術メモ。Zabbix / Raspberry Pi / QNAP / Windows Server / Linux /…</div></div></div></a><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/vmware-esxi65-realtek-nic.jpg&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;ESXiはINTEL NIC以外のネットワークアダプタを認識してくれない？！&lt;/p&gt;
&lt;p&gt;使わないパソコンが3台あって、VMware vSphere 
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
    
      <category term="VMware" scheme="https://lancers.work/tags/VMware/"/>
    
      <category term="ESXi" scheme="https://lancers.work/tags/ESXi/"/>
    
      <category term="仮想化" scheme="https://lancers.work/tags/%E4%BB%AE%E6%83%B3%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>WordPressクエリパラメータつきURLを静的URLにリライト ～ 完全版 ～</title>
    <link href="https://lancers.work/wordpress-custom-rewrite-rule/"/>
    <id>https://lancers.work/wordpress-custom-rewrite-rule/</id>
    <published>2019-04-03T22:55:00.000Z</published>
    <updated>2019-04-07T10:21:48.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/wordpress-custom-rewrite-rule.jpg" alt></p><p>本記事の目的はWordPressでクエリ文字付き動的URLを静的URLにリライトし、クエリパラメータの値を取得することです。</p><p>WordPressの公式サイト通りに関数を追加したり、コードを書けばできますが、その他のページをさまよっていてすぐに実装できなかったのでまとめておきます。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://kusanagi.lancers.work/food/?pref=hokkaido&amp;city=sapporo</span><br></pre></td></tr></table></figure><p>↑これを↓これにリライトし、クエリパラメータの値を取得します。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://kusanagi.lancers.work/food/hokkaido/sapporo</span><br></pre></td></tr></table></figure><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#2つの関数追加">2つの関数追加</a><ul><li><a href="#1カスタムクエリ文字列変数の認識">１．カスタムクエリ文字列変数の認識</a></li><li><a href="#2ユーザーフレンドリーなカスタムurlを作成">２．ユーザーフレンドリーなカスタムURLを作成</a></li></ul></li><li><a href="#パーマリンクデータベースの更新最重要">パーマリンクデータベースの更新（最重要）</a></li><li><a href="#クエリの値を受け取る">クエリの値を受け取る</a></li></ul><!-- tocstop --></div><h2><span id="2つの関数追加">2つの関数追加</span></h2><p>テーマファイル内のfunctions.phpに次の2つの関数を追加します。</p><h3><span id="1カスタムクエリ文字列変数の認識">１．カスタムクエリ文字列変数の認識</span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">custom_rewrite_tag</span></span>() &#123;</span><br><span class="line">    add_rewrite_tag(<span class="string">'%pref%'</span>, <span class="string">'([^&amp;]+)'</span>);</span><br><span class="line">    add_rewrite_tag(<span class="string">'%city%'</span>, <span class="string">'([^&amp;]+)'</span>);</span><br><span class="line">&#125;</span><br><span class="line">add_action(<span class="string">'init'</span>, <span class="string">'custom_rewrite_tag'</span>, 10, 0);</span><br></pre></td></tr></table></figure><p>ここでは<strong>prefやcityはクエリの文字列ですよ！</strong>とWordPressに認識させています。</p><p>クエリの文字列とは、例えば <code>https://kusanagi.lancers.work/food/?pref=hokkaido</code> の<strong>pref</strong>にあたります。</p><p><code>pref</code>や<code>city</code>以外の箇所は何も考えずコピペしてください。</p><h3><span id="2ユーザーフレンドリーなカスタムurlを作成">２．ユーザーフレンドリーなカスタムURLを作成</span></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">custom_rewrite_rule</span></span>() &#123;</span><br><span class="line">    add_rewrite_rule(<span class="string">'^food/([^/]*)/([^/]*)/?$'</span>, <span class="string">'index.php?page_id=固定ページの番号&amp;pref=$matches[1]&amp;city=$matches[2]'</span>, <span class="string">'top'</span>);</span><br><span class="line">&#125;</span><br><span class="line">add_action(<span class="string">'init'</span>, <span class="string">'custom_rewrite_rule'</span>, 10, 0);</span><br></pre></td></tr></table></figure><p>ここでは静的URLと動的URLの関連付けを行っています。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add_rewrite_rule(<span class="string">'^food/([^/]*)/([^/]*)/?$'</span></span><br></pre></td></tr></table></figure><p>今回は、クエリ文字がprefとcityの2つありますので、<code>/([^/])/([^/])/</code>のように記述します。</p><p>最初の()内がpref相当、次の()内がcityにあたります。クエリ文字の数だけ記述してください。</p><p>そして、クエリの値を受け取るのが、</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'index.php?page_id=固定ページの番号&amp;pref=$matches[1]&amp;city=$matches[2]'</span></span><br></pre></td></tr></table></figure><p>の箇所になります。</p><p><code>$matches</code>は定義された名前ですので、<code>$matches</code>は修正せず、パラメータの数だけ、[1]、[2]、[3]・・・と振ってあげます。<br>※<code>$matches[1]</code>に最初のクエリパラメータの値が入りますので、0からでなく1から始めます。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><h2><span id="パーマリンクデータベースの更新最重要">パーマリンクデータベースの更新（最重要）</span></h2><p><strong>この作業を忘れると、どんなに関数を追加しても反映されません。</strong></p><p>「設定」→「パーマリンク設定」で何も変更せずに「変更を保存」ボタンを押して、パーマリンクのデータベースを更新します。</p><p><img src="/images/wordpress-custom-rewrite-rule-1.jpg" alt></p><h2><span id="クエリの値を受け取る">クエリの値を受け取る</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">global <span class="variable">$wp_query</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pref</span> = <span class="variable">$wp_query</span>-&gt;query_vars[<span class="string">'pref'</span>];</span><br><span class="line"><span class="variable">$city</span>= <span class="variable">$wp_query</span>-&gt;query_vars[<span class="string">'city'</span>];</span><br></pre></td></tr></table></figure><p>とすることで<code>pref</code>の値<code>hokkaido</code>を取得することができます。</p><p><code>city=sapporo</code>も同様に取得できます。</p><p>以上の流れで、WordPressの動的URLを静的URLに変換し、クエリパラメータの値を取得することができます。</p><p>WordPressのカスタムリライトが効かないというかたは、是非この順に沿って設定してみてください。</p><p>この記事がお役に立てるととても嬉しいです！</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/wordpress-custom-rewrite-rule.jpg&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;本記事の目的はWordPressでクエリ文字付き動的URLを静的URLにリライトし、クエリパラメータの値を取得することです。&lt;/p&gt;
&lt;p&gt;Wo
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
    
      <category term="WordPress" scheme="https://lancers.work/tags/WordPress/"/>
    
  </entry>
  
  <entry>
    <title>Node.jsによるナンバーズアプリ ～ 2.配列のソート・jsonファイル保存編 ～</title>
    <link href="https://lancers.work/numbers-2/"/>
    <id>https://lancers.work/numbers-2/</id>
    <published>2019-04-03T09:40:00.000Z</published>
    <updated>2019-04-07T10:20:18.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/numbers-2.jpg" alt></p><p>※Node.jsアプリ作成の共有コーナーです。<br>※Node.jsアプリ作成にはExpressを使用しています。</p><p>今回はナンバーズ（NUMBERS3 &amp; NUMBERS4）の超お役立ちアプリ（大げさ）作成に関するナレッジの続き第2回目です。</p><a href="https://lancers.work/numbers3/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/numbers3.jpg"></div><div class="descriptions"><div class="og-title">ナンバーズ3アプリ</div><div class="og-description">ナンバーズ4はこちら ナンバーズ3 過去10回の当選数字  集計回数   ナンバーズ3 過去10回の当選数字出現回数      (adsby…</div></div></div></a><a href="https://lancers.work/numbers4/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/numbers4.jpg"></div><div class="descriptions"><div class="og-title">ナンバーズ4アプリ</div><div class="og-description">ナンバーズ3はこちら ナンバーズ4 過去10回の当選数字  集計回数   ナンバーズ4 過去10回の当選数字出現回数      (adsby…</div></div></div></a><p>前回の記事はこちらです。</p><a href="https://lancers.work/numbers-1/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/numbers-1.jpg"></div><div class="descriptions"><div class="og-title">Node.jsによるナンバーズアプリ ～ 1.スクレイピング編 ～</div><div class="og-description">※Node.jsアプリ作成の共有コーナーです。※Node.jsアプリ作成にはExpressを使用しています。 今回はナンバーズ（NUMBER…</div></div></div></a><p>今年の目標が<strong>Node.jsを極める！</strong>ですので、かなりの初心者コードですが、参考やヒラメキの一助になればと思い書いています。</p><p>今回でナンバーズアプリに関するナレッジは最終回です。</p><p>アプリが完成しましたら、公開していきたいと思います。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#配列のソート">配列のソート</a></li><li><a href="#jsonファイルの保存">jsonファイルの保存</a></li></ul><!-- tocstop --></div><h2><span id="配列のソート">配列のソート</span></h2><p><code>cheerio-httpcli</code>で取得した<code>回数</code>、<code>抽選日</code>、<code>当選番号</code>はそれぞれ<code>array.tit</code>、<code>array.date</code>、<code>array.win</code>に格納されています。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"tit"</span>:[<span class="string">"第5104回"</span>,<span class="string">"第5105回"</span>,<span class="string">"第5106回"</span>,<span class="string">"第5107回"</span>,<span class="string">"第5108回"</span>,<span class="string">"第5109回"</span>,<span class="string">"第5110回"</span>,<span class="string">"第5111回"</span>,<span class="string">"第5112回"</span>,<span class="string">"第5113回"</span>,<span class="string">"第5114回"</span>,<span class="string">"第5115回"</span>,<span class="string">"第5116回"</span>,<span class="string">"第5117回"</span>,<span class="string">"第5118回"</span>,<span class="string">"第5119回"</span>,<span class="string">"第5120回"</span>,<span class="string">"第5121回"</span>,<span class="string">"第5122回"</span>,<span class="string">"第5123回"</span>],<span class="string">"date"</span>:[<span class="string">"2019/02/01"</span>,<span class="string">"2019/02/04"</span>,<span class="string">"2019/02/05"</span>,<span class="string">"2019/02/06"</span>,<span class="string">"2019/02/07"</span>,<span class="string">"2019/02/08"</span>,<span class="string">"2019/02/11"</span>,<span class="string">"2019/02/12"</span>,<span class="string">"2019/02/13"</span>,<span class="string">"2019/02/14"</span>,<span class="string">"2019/02/15"</span>,<span class="string">"2019/02/18"</span>,<span class="string">"2019/02/19"</span>,<span class="string">"2019/02/20"</span>,<span class="string">"2019/02/21"</span>,<span class="string">"2019/02/22"</span>,<span class="string">"2019/02/25"</span>,<span class="string">"2019/02/26"</span>,<span class="string">"2019/02/27"</span>,<span class="string">"2019/02/28"</span>],<span class="string">"win"</span>:[<span class="string">"049"</span>,<span class="string">"766"</span>,<span class="string">"322"</span>,<span class="string">"660"</span>,<span class="string">"626"</span>,<span class="string">"684"</span>,<span class="string">"077"</span>,<span class="string">"882"</span>,<span class="string">"087"</span>,<span class="string">"446"</span>,<span class="string">"771"</span>,<span class="string">"878"</span>,<span class="string">"991"</span>,<span class="string">"956"</span>,<span class="string">"831"</span>,<span class="string">"672"</span>,<span class="string">"661"</span>,<span class="string">"635"</span>,<span class="string">"663"</span>,<span class="string">"366"</span>]&#125;</span><br></pre></td></tr></table></figure><p>これらを最新日付順にソートし、<code>numbers</code>という名前の配列に入れ直します。</p><p>まず、<code>回数</code>と<code>抽選日</code>と<code>当選番号</code>を組み合わせます。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(var i=0; i&lt;resJson.tit.length; i++) &#123;</span><br><span class="line">  var tit = arrayJson.tit[i];</span><br><span class="line">  var date = arrayJson.date[i];</span><br><span class="line">  var win = arrayJson.win[i];</span><br><span class="line">  numbers.push(&#123;tit, date, win&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>この結果、</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;<span class="string">"tit"</span>:<span class="string">"第5104回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/01"</span>,<span class="string">"win"</span>:<span class="string">"049"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5105回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/04"</span>,<span class="string">"win"</span>:<span class="string">"766"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5106回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/05"</span>,<span class="string">"win"</span>:<span class="string">"322"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5107回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/06"</span>,<span class="string">"win"</span>:<span class="string">"660"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5108回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/07"</span>,<span class="string">"win"</span>:<span class="string">"626"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5109回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/08"</span>,<span class="string">"win"</span>:<span class="string">"684"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5110回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/11"</span>,<span class="string">"win"</span>:<span class="string">"077"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5111回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/12"</span>,<span class="string">"win"</span>:<span class="string">"882"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5112回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/13"</span>,<span class="string">"win"</span>:<span class="string">"087"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5113回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/14"</span>,<span class="string">"win"</span>:<span class="string">"446"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5114回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/15"</span>,<span class="string">"win"</span>:<span class="string">"771"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5115回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/18"</span>,<span class="string">"win"</span>:<span class="string">"878"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5116回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/19"</span>,<span class="string">"win"</span>:<span class="string">"991"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5117回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/20"</span>,<span class="string">"win"</span>:<span class="string">"956"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5118回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/21"</span>,<span class="string">"win"</span>:<span class="string">"831"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5119回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/22"</span>,<span class="string">"win"</span>:<span class="string">"672"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5120回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/25"</span>,<span class="string">"win"</span>:<span class="string">"661"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5121回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/26"</span>,<span class="string">"win"</span>:<span class="string">"635"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5122回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/27"</span>,<span class="string">"win"</span>:<span class="string">"663"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5123回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/28"</span>,<span class="string">"win"</span>:<span class="string">"366"</span>&#125;]</span><br></pre></td></tr></table></figure><p>こうなります。</p><p>この状態で<code>date</code>をキーに抽選日降順にソートします。<br>※ツールで最新の当選番号が上に来るように設計したためソートします。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 降順の場合</span><br><span class="line">numbers.sort(<span class="keyword">function</span>(a,b) &#123;</span><br><span class="line">  <span class="keyword">if</span>(a.date &gt; b.date) <span class="built_in">return</span> -1;</span><br><span class="line">  <span class="keyword">if</span>(a.date &lt; b.date) <span class="built_in">return</span> 1;</span><br><span class="line">  <span class="built_in">return</span> 0;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>この結果、</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;<span class="string">"tit"</span>:<span class="string">"第5123回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/28"</span>,<span class="string">"win"</span>:<span class="string">"366"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5122回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/27"</span>,<span class="string">"win"</span>:<span class="string">"663"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5121回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/26"</span>,<span class="string">"win"</span>:<span class="string">"635"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5120回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/25"</span>,<span class="string">"win"</span>:<span class="string">"661"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5119回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/22"</span>,<span class="string">"win"</span>:<span class="string">"672"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5118回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/21"</span>,<span class="string">"win"</span>:<span class="string">"831"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5117回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/20"</span>,<span class="string">"win"</span>:<span class="string">"956"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5116回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/19"</span>,<span class="string">"win"</span>:<span class="string">"991"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5115回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/18"</span>,<span class="string">"win"</span>:<span class="string">"878"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5114回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/15"</span>,<span class="string">"win"</span>:<span class="string">"771"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5113回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/14"</span>,<span class="string">"win"</span>:<span class="string">"446"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5112回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/13"</span>,<span class="string">"win"</span>:<span class="string">"087"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5111回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/12"</span>,<span class="string">"win"</span>:<span class="string">"882"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5110回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/11"</span>,<span class="string">"win"</span>:<span class="string">"077"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5109回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/08"</span>,<span class="string">"win"</span>:<span class="string">"684"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5108回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/07"</span>,<span class="string">"win"</span>:<span class="string">"626"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5107回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/06"</span>,<span class="string">"win"</span>:<span class="string">"660"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5106回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/05"</span>,<span class="string">"win"</span>:<span class="string">"322"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5105回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/04"</span>,<span class="string">"win"</span>:<span class="string">"766"</span>&#125;,&#123;<span class="string">"tit"</span>:<span class="string">"第5104回"</span>,<span class="string">"date"</span>:<span class="string">"2019/02/01"</span>,<span class="string">"win"</span>:<span class="string">"049"</span>&#125;]</span><br></pre></td></tr></table></figure><p>こうなります。</p><p>これでアプリで使いたかったjson形式のナンバーズ当選番号データが完成しました。</p><h2><span id="jsonファイルの保存">jsonファイルの保存</span></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var fs = require(<span class="string">'fs'</span>);</span><br><span class="line">fs.writeFile(<span class="string">'numbers3.json'</span>, JSON.stringify(winJson));</span><br></pre></td></tr></table></figure><p>ファイルの保存は特に書くことはありません。</p><p>以上でNode.jsで作るナンバーズアプリの準備ができましたので、あとはこのデータを加工しながら当選ロジックを完成させたいと思います。</p><p>今作っているナンバーズアプリですがテレビでも放映された理論を取り入れたアプリです。</p><p>テレビでは理論上100％当選と謳っていて、実際に当選していました。</p><p>ですので、ナンバーズアプリの公開を期待していてください！</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/numbers-2.jpg&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;※Node.jsアプリ作成の共有コーナーです。&lt;br&gt;※Node.jsアプリ作成にはExpressを使用しています。&lt;/p&gt;
&lt;p&gt;今回はナンバーズ（NUMBERS3 &amp;amp; NU
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
      <category term="アプリの素" scheme="https://lancers.work/categories/%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E7%B4%A0/"/>
    
    
      <category term="Node.js" scheme="https://lancers.work/tags/Node-js/"/>
    
      <category term="Express" scheme="https://lancers.work/tags/Express/"/>
    
  </entry>
  
  <entry>
    <title>Node.jsによるナンバーズアプリ ～ 1.スクレイピング編 ～</title>
    <link href="https://lancers.work/numbers-1/"/>
    <id>https://lancers.work/numbers-1/</id>
    <published>2019-04-03T09:39:00.000Z</published>
    <updated>2019-04-07T10:19:58.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/numbers-1.jpg" alt></p><p>※Node.jsアプリ作成の共有コーナーです。<br>※Node.jsアプリ作成にはExpressを使用しています。</p><p>今回はナンバーズ（NUMBERS3 &amp; NUMBERS4）の超お役立ちアプリ（大げさ）に関するナレッジです！</p><a href="https://lancers.work/numbers3/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/numbers3.jpg"></div><div class="descriptions"><div class="og-title">ナンバーズ3アプリ</div><div class="og-description">ナンバーズ4はこちら ナンバーズ3 過去10回の当選数字  集計回数   ナンバーズ3 過去10回の当選数字出現回数      (adsby…</div></div></div></a><a href="https://lancers.work/numbers4/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/numbers4.jpg"></div><div class="descriptions"><div class="og-title">ナンバーズ4アプリ</div><div class="og-description">ナンバーズ3はこちら ナンバーズ4 過去10回の当選数字  集計回数   ナンバーズ4 過去10回の当選数字出現回数      (adsby…</div></div></div></a><p>瞬時に直近○○回分の当選数字と当選回数を表示します！（直近30回分が対象）</p><p>以前、KUSANAGIのWordPress上でPHPで組んだツールの焼き直しです。</p><p>アプリの公開は後日追記しますので、本記事はプログラムの流れの備忘録です。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#スクレイピングcheerio-httpcli">スクレイピング（cheerio-httpcli）</a></li></ul><!-- tocstop --></div><h2><span id="スクレイピングcheerio-httpcli">スクレイピング（cheerio-httpcli）</span></h2><p>Node.jsでナンバースの当選番号を某サイトからスクレイピングするプログラムを書きました。</p><p>スクレイピングの結果はjsonファイルに保存し、1日に1回更新とし、相手先のサイトに迷惑をかけないようにしています。</p><p>スクレイピングのモジュールはcheerio-httpcliを使いました。</p><p>今回はスクレイピングの結果を保存する関係で、同期処理にて組みました。</p><p><code>cheerio-httpcli</code>の非同期処理の書き方</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var client = require(<span class="string">'cheerio-httpcli'</span>);</span><br><span class="line"></span><br><span class="line">client.fetch(<span class="string">'https://対象URL/'</span>, &#123;&#125;, <span class="keyword">function</span> (err, $, result) &#123;</span><br><span class="line">  ・・・</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>普通にデータ収集・加工後にデータをまとめてjsonファイルに保存しようとすると、保存処理が先に走ってしまい、空のファイルが出来上がってしまいました。</p><p>いろいろやり方はあると思いますが（教えてください！）、今回は同期処理にてスクレイピング → ファイル保存を行いました。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">var client = require(<span class="string">'cheerio-httpcli'</span>);</span><br><span class="line"></span><br><span class="line">var array = &#123;&#125;;</span><br><span class="line">array.tit = [];</span><br><span class="line">array.date = [];</span><br><span class="line">array.win = [];</span><br><span class="line"></span><br><span class="line">var html = client.fetchSync(<span class="string">'https://某NUMBERS当選番号公開ページURL/'</span>);</span><br><span class="line"></span><br><span class="line">// 第○○回を取得</span><br><span class="line">html.$(<span class="string">'th'</span>).each(<span class="keyword">function</span> (idx) &#123;</span><br><span class="line">  <span class="keyword">if</span>(html.$(this).text().match(<span class="string">'第'</span>)) &#123;</span><br><span class="line">    array.tit.push(html.$(this).text());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 抽選日を取得</span><br><span class="line">html.$(<span class="string">'td'</span>).each(<span class="keyword">function</span> (idx) &#123;</span><br><span class="line">  <span class="keyword">if</span>(html.$(this).text().match(<span class="string">'/'</span>)) &#123;</span><br><span class="line">    array.date.push(html.$(this).text());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 当選番号を取得    </span><br><span class="line">html.$(<span class="string">'td'</span>).each(<span class="keyword">function</span> (idx) &#123;</span><br><span class="line">  <span class="keyword">if</span>(html.$(this).text() &lt; 1000) &#123;</span><br><span class="line">    array.win.push(html.$(this).text());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>このサイトの当選番号は<code>table</code>で表示しているのですが、抽選日ごとに<code>table</code>があったり、<code>th</code>や<code>td</code>などにclassがあてられてなかったり、かつ、データの並びをうまく整理できず、<code>eq(0)</code>などで正常に取得できなかったので、非常に原始的な処理にしました。</p><ul><li>第1234回という回数は<code>th</code>に<code>第</code>の文字が含まれていたら回数として取得</li><li>抽選日は<code>td</code>に<code>/</code>が入っていたら日付として取得</li><li>当選番号（ナンバーズ3）の場合、当選数字は最大値として見ると999なので、1000以下の数字が<code>td</code>に入っていたら当選番号として取得</li></ul><p>こんな感じでターゲットのデータを取得し、配列に格納しています。</p><p>PHPではスマートに書けけているので、もう少し考えてみようとは思っています。</p><p>それでは長くなりましたので、今回はスクレイピングまでということで、その他のナレッジについては次回に続きます。</p><a href="https://lancers.work/numbers-2/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/numbers-2.jpg"></div><div class="descriptions"><div class="og-title">Node.jsによるナンバーズアプリ ～ 2.配列のソート・jsonファイル保存編 ～</div><div class="og-description">※Node.jsアプリ作成の共有コーナーです。※Node.jsアプリ作成にはExpressを使用しています。 今回はナンバーズ（NUMBER…</div></div></div></a><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/numbers-1.jpg&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;※Node.jsアプリ作成の共有コーナーです。&lt;br&gt;※Node.jsアプリ作成にはExpressを使用しています。&lt;/p&gt;
&lt;p&gt;今回はナンバーズ（NUMBERS3 &amp;amp; NU
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
      <category term="アプリの素" scheme="https://lancers.work/categories/%E3%82%A2%E3%83%97%E3%83%AA%E3%81%AE%E7%B4%A0/"/>
    
    
      <category term="Node.js" scheme="https://lancers.work/tags/Node-js/"/>
    
      <category term="Express" scheme="https://lancers.work/tags/Express/"/>
    
  </entry>
  
  <entry>
    <title>Hexoのサイドバーのアーカイブ日付表示の変更方法</title>
    <link href="https://lancers.work/hexo-hueman-list-archives-date/"/>
    <id>https://lancers.work/hexo-hueman-list-archives-date/</id>
    <published>2019-04-02T04:40:00.000Z</published>
    <updated>2019-04-07T10:18:02.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/archives-list-date-fix.jpg" alt></p><p>Hexoでブログを書き始めてかなり満足度の高い作業ができています。</p><p>Hexoブログ開設以来、ずっと気になっていて修正方法がわからなかった箇所があります。</p><p>ここです。</p><p><img src="/images/archives-list-date-before.jpg" alt></p><p>サイドバーの<strong>アーカイブの日付が漢数字</strong>になっています。</p><p>今回はこの日付の表示方法を変更していきましょう！</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#archiveejsの修正">archive.ejsの修正</a></li></ul><!-- tocstop --></div><h2><span id="archiveejsの修正">archive.ejsの修正</span></h2><p>このブログのテーマは、<strong>hueman</strong>を使っていますので、他のテーマの方は記事内容を適宜読み替えたり、参考にしてみてください。</p><a href="https://github.com/ppoffice/hexo-theme-hueman" class="link-preview" target="_blank" rel="nofollow"><div class="link-area"><div class="og-image"><img src="https://avatars0.githubusercontent.com/u/8849362?s=400&v=4"></div><div class="descriptions"><div class="og-title">ppoffice/hexo-theme-hueman</div><div class="og-description">A redesign of Alx&#39;s wordpress theme hueman, ported to Hexo. - ppoffice…</div></div></div></a><p>編集するファイルは、</p><p><code>/~/Hexoブログフォルダ/themes/hueman/layout/widget/archive.ejs</code></p><p>です。</p><p>ファイルの中身は、</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (site.posts.length) &#123; %&gt;</span><br><span class="line">    &lt;div class=<span class="string">"widget-wrap widget-list"</span>&gt;</span><br><span class="line">        &lt;h3 class=<span class="string">"widget-title"</span>&gt;&lt;%= __(<span class="string">'sidebar.archives'</span>) %&gt;&lt;/h3&gt;</span><br><span class="line">        &lt;div class=<span class="string">"widget"</span>&gt;</span><br><span class="line">            &lt;%- list_archives() %&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure><p>となっています。</p><p>この5行目を次のように修正します。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%- list_archives(&#123;format: <span class="string">"YYYY年MM月"</span>&#125;) %&gt;</span><br></pre></td></tr></table></figure><p><code>&quot;YYYY年MM月&quot;</code>としましたが、<code>&quot;YYYY/MM&quot;</code>や<code>&quot;YYYY-MM&quot;</code>でも問題ありません。</p><p>この修正だけで、最初の中華っぽい漢数字の日付から洋風なオシャレ（？）な日付表示に変更できました。</p><p>これでかなりHexoブログのカスタマイズが進み、ほぼ現時点では完成に近い感じです。</p><p>しいて言えば、関連記事の表示をもう少し工夫したいところです。</p><p>これからNode.jsアプリをガシガシ作って、このブログで公開したり、ノウハウの共有をしていきたいと思います。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/archives-list-date-fix.jpg&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;Hexoでブログを書き始めてかなり満足度の高い作業ができています。&lt;/p&gt;
&lt;p&gt;Hexoブログ開設以来、ずっと気になっていて修正方法がわからなかった箇所があ
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
    
      <category term="Node.js" scheme="https://lancers.work/tags/Node-js/"/>
    
      <category term="Hexo" scheme="https://lancers.work/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>Hexoのプラグインが機能しないので修正してみた ～ hexo-toc編 ～</title>
    <link href="https://lancers.work/hexo-plugin-fix-toc/"/>
    <id>https://lancers.work/hexo-plugin-fix-toc/</id>
    <published>2019-03-31T22:19:00.000Z</published>
    <updated>2019-04-07T10:19:42.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/hexo-toc-fix.jpg" alt></p><p>KUSANAGI（WordPress）からHexoへブログを移行して数日がたちました。</p><p>ブログをガシガシ書き始めたというより、ブログの体裁を整える日を送っています。</p><p>そんな中、Hexoのプラグインが機能しないという症状に度々遭遇したので、修正した内容を備忘録として書き留めていきます。</p><p>なお、この修正は管理人の環境、管理人仕様的なところがあります。</p><p>gitにもnpmにも上げていませんし、プラグインが更新されるとまた修正しなければいけませんし、修正版を公開するところまで至っていません。</p><p>また、プラグインの使い方が間違っているよ！ということもあるかもしれません。</p><p>以上を踏まえて、修正される方の参考になれば幸いです。</p><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#hexo-toc-不具合の症状">hexo-toc 不具合の症状</a></li><li><a href="#hexo-toc-不具合の解消">hexo-toc 不具合の解消</a><ul><li><a href="#修正対象ファイルlibfilterjs">修正対象ファイル：lib/filter.js</a></li><li><a href="#おまけ">おまけ</a></li></ul></li></ul><!-- tocstop --></div><h2><span id="hexo-toc-不具合の症状">hexo-toc 不具合の症状</span></h2><p>言わずとしれた、ブログに目次を自動で付けてくれるプラグインです。</p><a href="https://www.npmjs.com/package/hexo-toc" class="link-preview" target="_blank" rel="nofollow"><div class="link-area"><div class="og-image"><img src="https://static.npmjs.com/338e4905a2684ca96e08c7780fc68412.png"></div><div class="descriptions"><div class="og-title">hexo-toc</div><div class="og-description">Insert a markdown TOC(Table Of Content) before posts be rendered. </div></div></div></a><p>目次自体は<code>&lt;！-- toc --&gt;</code>を記事内に記述することで表示はできました。</p><p>しかし、<code>_config.yml</code>に記述したオプションが効かないのです。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">toc:</span><br><span class="line">  maxdepth: 3</span><br><span class="line">  class: toc</span><br><span class="line">  slugify: transliteration</span><br><span class="line">  decodeEntities: <span class="literal">false</span></span><br><span class="line">  anchor:</span><br><span class="line">    position: after</span><br><span class="line">    symbol: <span class="string">'#'</span></span><br><span class="line">    style: header-anchor</span><br></pre></td></tr></table></figure><p>特に目次のデザインを調整したくclassをあてたかったので、class<code>toc</code>を追加するよう修正していきます。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><h2><span id="hexo-toc-不具合の解消">hexo-toc 不具合の解消</span></h2><p>プラグインの実体は<code>node_modules</code>フォルダ内にあります。</p><p>hexo-tocの場合、そのまんま<code>hexo-toc</code>フォルダになります。</p><p>不具合解消の基本的な流れとして、オプションでclassが指定されていたらその指定値をclass名とするという仕様ですので、オプションの指定に関わらず、class<code>toc</code>を追加します。</p><h3><span id="修正対象ファイルlibfilterjs">修正対象ファイル：lib/filter.js</span></h3><p>※コードのブログでの表示上、大文字になっている箇所があります。</p><p>9行目～12行目</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// add class option</span><br><span class="line">if (options.class) &#123;</span><br><span class="line">  data.content = data.content.replace("<span class="tag">&lt;<span class="name">！--</span> <span class="attr">toc</span> <span class="attr">--</span>&gt;</span>", '<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"' + options.class + 'Start"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">！--</span> <span class="attr">toc</span> <span class="attr">--</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"' + options.class + 'End"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>');</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>これを、</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// add class option</span><br><span class="line">data.content = data.content.replace("<span class="tag">&lt;<span class="name">！--</span> <span class="attr">toc</span> <span class="attr">--</span>&gt;</span>", '<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tocStart"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">！--</span> <span class="attr">toc</span> <span class="attr">--</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tocEnd"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>');</span><br></pre></td></tr></table></figure><p>54行目～57行目</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// add class option</span><br><span class="line">if (options.class) &#123;</span><br><span class="line">  data.content = data.content.replace('<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"' + options.class + 'Start"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>', '<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"' + options.class + '"</span>&gt;</span>').replace('<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"' + options.class + 'End"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>', '<span class="tag">&lt;/<span class="name">div</span>&gt;</span>');</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>これを</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// add class option</span><br><span class="line">data.content = data.content.replace('<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tocStart"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>', '<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"toc"</span>&gt;</span>').replace('<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tocEnd"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>', '<span class="tag">&lt;/<span class="name">div</span>&gt;</span>');</span><br></pre></td></tr></table></figure><p>これでclass<code>toc</code>が当たりますので、あとはCSSでお好きなデザインにカスタマイズしてみてください。</p><h3><span id="おまけ">おまけ</span></h3><p>目次のタイトルの修正も合わせて行いました。</p><p>タイトルのidが<code>&lt;span id=&quot;目次&quot;&gt;</code>となってしまっていたことと、その度tocタグの上に<code>目次</code>と入力するのが面倒なので、上の修正箇所を更に修正して、</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// add class option</span><br><span class="line">data.content = data.content.replace('<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tocStart"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>', '<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"toc-title"</span>&gt;</span>目　次<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"toc"</span>&gt;</span>').replace('<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tocEnd"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>', '<span class="tag">&lt;/<span class="name">div</span>&gt;</span>');</span><br></pre></td></tr></table></figure><p>というように<code>目次</code>というテキストとclassを予め付加しました。</p><p>汎用性がなくなる記述ですが、目次のタイトルは<strong>目次</strong>ですし、class（id）も日本語でなくなるので、超個人的ではありますが、このブログではこちらを使っていきます。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/hexo-toc-fix.jpg&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;KUSANAGI（WordPress）からHexoへブログを移行して数日がたちました。&lt;/p&gt;
&lt;p&gt;ブログをガシガシ書き始めたというより、ブログの体裁を整える日を送っています。
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
    
      <category term="Node.js" scheme="https://lancers.work/tags/Node-js/"/>
    
      <category term="Hexo" scheme="https://lancers.work/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>Hexoのプラグインが機能しないので修正してみた ～ hexo-tag-link-preview編 ～</title>
    <link href="https://lancers.work/hexo-plugin-fix-tag-link-preview/"/>
    <id>https://lancers.work/hexo-plugin-fix-tag-link-preview/</id>
    <published>2019-03-31T22:19:00.000Z</published>
    <updated>2019-04-07T10:19:22.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/hexo-tag-link-preview-fix.jpg" alt></p><p>「Hexoのプラグインが機能しないので修正してみた」第二弾は<code>hexo-tag-link-preview</code>です。</p><p>このプラグインはリンク先をカードのように表示してくれるカッコいいプラグインです。こんな感じ。</p><a href="https://lancers.work/hexo-plugin-fix-toc/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/hexo-toc-fix.jpg"></div><div class="descriptions"><div class="og-title">Hexoのプラグインが機能しないので修正してみた ～ hexo-toc編 ～</div><div class="og-description">KUSANAGI（WordPress）からHexoへブログを移行して数日がたちました。 ブログをガシガシ書き始めたというより、ブログの体裁を…</div></div></div></a><p>この連載記事シリーズは管理人の環境に依存、管理人仕様的なところがあります。</p><p>gitにもnpmにも上げていませんし、プラグインが更新されるとまた修正しなければいけませんし、かといって修正版を公開するところまで至っていません。</p><p>また、プラグインの使い方が間違っているよ！ということもあるかもしれません。<br>（製作者の方、すみません。）</p><p>以上を踏まえて、同じところで悩まれ修正することができた人がいれば嬉しい限りです。</p><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#hexo-tag-link-preview-不具合の症状">hexo-tag-link-preview 不具合の症状</a></li><li><a href="#hexo-tag-link-preview-不具合の解消">hexo-tag-link-preview 不具合の解消</a><ul><li><a href="#修正対象ファイルindexjs">修正対象ファイル：index.js</a></li></ul></li></ul><!-- tocstop --></div><h2><span id="hexo-tag-link-preview-不具合の症状">hexo-tag-link-preview 不具合の症状</span></h2><p>今回の不具合の気づきは、このプラグインであるあタグ<code>｛% linkPreview https://www.amazon.com/ _blank nofollow %｝</code>（例、}は表示上大文字になっています）を記事内に記述したところエラーで静的ファイルが生成されなかったことにあります。</p><p>タグの記述を何回見直しても正しかったので、これはプラグインファイルに原因が！ということで、該当ファイルを修正したところ上記のように表示されるようになりました。</p><p>この不具合は後日談ですが<code>hexo s</code>のエラーメッセージをよく見ればすぐに解決する内容でした。</p><p>もう一点、<code>_config.yml</code>に記述したオプションが機能しないということです。</p><p>class名をあてられないのは前回の<code>hexo-toc</code>より大きな問題ではありませんでしたが（管理人のケース）、キャプションの文字数が反映されないのが困りました。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><h2><span id="hexo-tag-link-preview-不具合の解消">hexo-tag-link-preview 不具合の解消</span></h2><p>プラグインの実体は<code>node_modules</code>フォルダ内にあります。</p><p>hexo-tag-link-previewの実体は<code>hexo-tag-link-preview</code>フォルダになります。</p><h3><span id="修正対象ファイルindexjs">修正対象ファイル：index.js</span></h3><p>25行目</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">async <span class="keyword">function</span> getTag(options) &#123;</span><br></pre></td></tr></table></figure><p>これを、</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> getTag(options) &#123;</span><br></pre></td></tr></table></figure><p>というように先頭の<code>async</code>を削除したところ、<code>hexo s</code>、<code>hexo g</code>を実行してもエラーが出なくなり静的ファイルが生成されるようになりました。</p><p><code>async</code>は非同期処理を実行するためにつけるのですが、同期処理でも今のところ問題ないので、削除したまま使っています。</p><p>キャプションの文字数は<code>_config.yml</code>で変更できない状況にあるため、同じファイル<code>index.js</code>に直書きしてしのいでいます。</p><p>15行目</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? hexo.config.linkPreview.descriptionLength : 70;</span><br></pre></td></tr></table></figure><p>末尾の数字を変更します。</p><p>以上、2点の不具合の解決方法はこれだけとなります。</p><p>本記事執筆現在手を加えたプラグインは2つですが、Hexoには便利なプラグインたくさんありますね。</p><p>今までKUSANAGI（WordPress）で作っていた表現がほぼ表現できます。</p><p>WordPressはかなり昔から使っていましたが、今では当たり前になって多くの人が使い、なんとなく嫌気がさしていたので、Hexoに乗り換えて正解です！</p><p>動的サイト、WordPress、PHPから脱却してみませんか？</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/hexo-tag-link-preview-fix.jpg&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;「Hexoのプラグインが機能しないので修正してみた」第二弾は&lt;code&gt;hexo-tag-link-preview&lt;/code&gt;です。&lt;/p&gt;
&lt;p&gt;こ
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
    
      <category term="Node.js" scheme="https://lancers.work/tags/Node-js/"/>
    
      <category term="Hexo" scheme="https://lancers.work/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>KUSANAGIのLAMP環境にHexoを構築</title>
    <link href="https://lancers.work/hexo-on-kusanagi/"/>
    <id>https://lancers.work/hexo-on-kusanagi/</id>
    <published>2019-03-29T22:10:00.000Z</published>
    <updated>2019-04-07T10:19:04.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/hexo-on-kusanagi.jpg" alt></p><p>まだHexoでブログを書き始めたばかりで、正直Node.jsでのWEBアプリ開発はまだ本格的に始めていません。</p><p>HexoはNode.jsをほとんど意識せず、テキストを書き続けることで爆速ブログができていきますので、これはこれで楽しいです。</p><p>そんなHexoですが運営環境としてKUSANAGIとの連携が簡単というのが今回のお話です。</p><p>特にNode.jsやHexo初心者の方にはおすすめです。</p><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#kusanagiの特徴">KUSANAGIの特徴</a></li><li><a href="#kusanagi環境へhexoをインストールする">KUSANAGI環境へHexoをインストールする</a><ul><li><a href="#kusanagiによるlampプロビジョニング">KUSANAGIによるLAMPプロビジョニング</a></li><li><a href="#hexoインストール">Hexoインストール</a></li><li><a href="#nginx設定">Nginx設定</a></li></ul></li></ul><!-- tocstop --></div><h2><span id="kusanagiの特徴">KUSANAGIの特徴</span></h2><p><strong>KUSANAGI</strong>とは超高速WordPress仮想マシンです。</p><p>KUSANAGIはWordPressを高速に動かすだけでなく、すばやくLAMP環境を構築したり、<strong>Let’s Encrypt</strong>によるSSL化を簡単にしたり、複数のWordPressなどを追加・削除できます。</p><p>このようにサーバー運営に必要な機能がてんこ盛り、かつ、便利な仮想マシンです。</p><p>このKUSANAGI環境とHexoを組み合わせて、簡単にHexoブログを公開しようというのが本記事の内容です。</p><h2><span id="kusanagi環境へhexoをインストールする">KUSANAGI環境へHexoをインストールする</span></h2><p>Node.jsのインストールはこちらの記事を参考に済ませておいてください。</p><a href="https://lancers.work/hexo-nodejs-blog/" class="link-preview"><div class="link-area"><div class="og-image"><img src="https://lancers.work/thumbnail/hexo-start-nodejs.jpg"></div><div class="descriptions"><div class="og-title">Hexo（node.js）で静的ブログを構築してみる</div><div class="og-description">もともとは、超高速WordPress仮想マシン「KUSANAGI」でWEBアプリを量産しようということで、KUSANAGIでブログを書いてい…</div></div></div></a><h3><span id="kusanagiによるlampプロビジョニング">KUSANAGIによるLAMPプロビジョニング</span></h3><p>KUSANAGIでLAMPをプロビジョニングします。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kusanagi provision --lamp hexo-blog</span><br></pre></td></tr></table></figure><p><code>--lamp</code>を省略してしまいますとWordPressがインストールされてしましますので、<code>--lamp</code>は必須です。</p><p><code>--lamp</code>を指定したので、WordPressはインストールされず、プロファイル名<code>hexo-blog</code>（任意の名前で可）の空のドキュメントルートが作成されます。</p><p>プロビジョニング作業が進んでいくと、ドメインの設定やLet’s EncryptによるSSL化が実行されますので、この後のHexoインストール作業後にSSL化作業などを行う必要がありません、ここが楽です！</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><h3><span id="hexoインストール">Hexoインストール</span></h3><p>Hexo自体をインストールしていない人は、下記コマンドでインストールしてください。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-cli -g</span><br></pre></td></tr></table></figure><p>KUSANAGIで作成したLAMPのドキュメントルートにHexoをインストールします。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># LAMPドキュメントルートへ移動</span></span><br><span class="line">$ <span class="built_in">cd</span> /home/kusanagi/hexo-blog/DocumentRoot</span><br><span class="line"></span><br><span class="line"><span class="comment"># blogは任意の名前でOK</span></span><br><span class="line">$ hexo init blog</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> blog</span><br><span class="line"></span><br><span class="line">$ npm install</span><br></pre></td></tr></table></figure><p>これで<code>/home/kusanagi/hexo-blog/DocumentRoot/blog</code>にHexoブログ一式がインストールされます。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>サーバーを起動し<code>localhost:4000</code>または<code>ローカルIPアドレス:4000</code>にアクセスして、サンプルサイトが表示されることを確認してみてください。</p><h3><span id="nginx設定">Nginx設定</span></h3><p>KUSANAGIでLAMPを構築しますと、</p><ul><li><code>/etc/nginx/conf.d/hexo-blog_http.conf</code> </li><li><code>/etc/nginx/conf.d/hexo-blog_ssl.conf</code></li></ul><p>というファイルが作成されています。</p><p>これらのconfファイルのルートディレクトリの記述を次のように書き換えます。</p><p><code>root  /home/kusanagi/hexo-blog/DocumentRoot/blog/public;</code></p><p>最後の<code>public</code>は固定文字列です。</p><p>Hexoで静的ファイルを生成すると<code>public</code>フォルダにブログの静的ファイルが格納されますので、それをそのまま公開用のディレクトリにしてしまおうという設定です。</p><p>GitHub PagesやNetlifyにデプロイすることもできますが、お手軽に独自ドメインで公開するにはKUSANAGIを使うと難易度が下がると思います。</p><p>KUSANAGIとHexoの連携いかがでしたでしょうか？</p><p>KUSANAGI（WordPress）からHexo（Node.js）に移行しましたが、やはりKUSANAGIは素晴らしい仕組みです。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/hexo-on-kusanagi.jpg&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;まだHexoでブログを書き始めたばかりで、正直Node.jsでのWEBアプリ開発はまだ本格的に始めていません。&lt;/p&gt;
&lt;p&gt;HexoはNode.jsをほとんど意識せず、
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
    
      <category term="Node.js" scheme="https://lancers.work/tags/Node-js/"/>
    
      <category term="KUSANAGI" scheme="https://lancers.work/tags/KUSANAGI/"/>
    
      <category term="let&#39;s encrypt" scheme="https://lancers.work/tags/let-s-encrypt/"/>
    
  </entry>
  
  <entry>
    <title>都道府県・市区町村フォームをできる限り少ない行数で書いてみる</title>
    <link href="https://lancers.work/pref-city-form-jquery-json/"/>
    <id>https://lancers.work/pref-city-form-jquery-json/</id>
    <published>2019-03-29T06:53:00.000Z</published>
    <updated>2019-04-07T10:21:15.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/pref-city-form.jpg" alt></p><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#基本データ都道府県市区町村-json形式データ">基本データ（都道府県・市区町村 json形式データ）</a></li><li><a href="#jqueryで都道府県市区町村連動型フォームを作る">jQueryで都道府県・市区町村連動型フォームを作る</a><ul><li><a href="#サンプル">サンプル</a></li><li><a href="#jqueryソース">jQueryソース</a></li><li><a href="#htmlソース">HTMLソース</a></li></ul></li></ul><!-- tocstop --></div><h2><span id="基本データ都道府県市区町村-json形式データ">基本データ（都道府県・市区町村 json形式データ）</span></h2><p>当ブログで用意している都道府県・市区町村のjsonデータの形式は、</p><p><code>[{&quot;01&quot;:{&quot;id&quot;:&quot;01″,&quot;pref&quot;:&quot;北海道&quot;,&quot;en&quot;:&quot;hokkaido&quot;,&quot;city&quot;:[{&quot;id&quot;:&quot;01100″,&quot;name&quot;:&quot;札幌市&quot;},{&quot;id&quot;:&quot;01101″,&quot;name&quot;:&quot;中央区&quot;}, ・・・]</code></p><p>となっています。</p><ul><li>キー</li><li>id：都道府県コード</li><li>pref：都道府県名</li><li>en：都道府県英字名</li><li>city：市区町村データ（id：市区町村コード、name：市区町村名）</li></ul><p>常に最新の「都道府県・市区町村jsonデータ」は↓こちらのリンク↓からダウンロードできます。</p><p><a href="https://lancers.work/json/pref_city.json" download="pref_city.json">都道府県・市区町村 jsonデータ</a></p><p>※データは毎日更新しています。<br>※クリックでダウンロードできない場合は、右クリックでリンク先を保存してください。<br>※ご利用の際はダウンロードしてお使いください。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><h2><span id="jqueryで都道府県市区町村連動型フォームを作る">jQueryで都道府県・市区町村連動型フォームを作る</span></h2><h3><span id="サンプル">サンプル</span></h3><select id="select-pref"><option value>都道府県を選択してください</option></select><select id="select-city"><option value>市区町村を選択してください</option></select><script>// 都道府県フォーム生成$(function() {  $.getJSON('../../json/pref_city.json', function(data) {    for(var i=0; i<47; i++) {      var code = i+1;      code = ('00'+code).slice(-2);      $('#select-pref').append('<option value="'+code+'">'+data[i][code].pref+'</option>');    }  });});// 市区町村フォーム連動$('#select-pref').on('change', function() {  $('#select-city option:nth-child(n+2)').remove(); // ※1 市区町村フォームクリア    var select_pref = ('00'+$('#select-pref option:selected').val()).slice(-2);    var key = Number(select_pref)-1;    $.getJSON('../../json/pref_city.json', function(data) {      for(var i=0; i<data[key][select_pref].city.length; i++){        $('#select-city').append('<option value="'+data[key][select_pref].city[i].id+'">'+data[key][select_pref].city[i].name+'</option>');      }  });});</script><h3><span id="jqueryソース">jQueryソース</span></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">// 都道府県フォーム生成</span></span><br><span class="line"><span class="undefined">$(function() &#123;</span></span><br><span class="line"><span class="undefined">  $.getJSON('pref_city.json', function(data) &#123;</span></span><br><span class="line"><span class="undefined">    for(var i=0; i&lt;47; i++) &#123;</span></span><br><span class="line"><span class="undefined">      var code = i+1;</span></span><br><span class="line"><span class="undefined">      code = ('00'+code).slice(-2);</span></span><br><span class="line"><span class="xml">      $('#select-pref').append('<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"'+code+'"</span>&gt;</span>'+data[i][code].pref+'<span class="tag">&lt;/<span class="name">option</span>&gt;</span>');</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;);</span></span><br><span class="line"><span class="undefined">&#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">// 市区町村フォーム連動</span></span><br><span class="line"><span class="undefined">$('#select-pref').on('change', function() &#123;</span></span><br><span class="line"><span class="undefined">  $('#select-city option:nth-child(n+2)').remove(); // ※1 市区町村フォームクリア</span></span><br><span class="line"><span class="undefined">    var select_pref = ('00'+$('#select-pref option:selected').val()).slice(-2);</span></span><br><span class="line"><span class="undefined">    var key = Number(select_pref)-1;</span></span><br><span class="line"><span class="undefined">    $.getJSON('pref_city.json', function(data) &#123;</span></span><br><span class="line"><span class="undefined">      for(var i=0; i&lt;data[key][select_pref].city.length; i++)&#123;</span></span><br><span class="line"><span class="xml">        $('#select-city').append('<span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"'+data[key][select_pref].city[i].id+'"</span>&gt;</span>'+data[key][select_pref].city[i].name+'<span class="tag">&lt;/<span class="name">option</span>&gt;</span>');</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">  &#125;);</span></span><br><span class="line"><span class="undefined">&#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>4行目の<code>$.getJSON(&#39;pref_city.json&#39;, function(data) {</code>の<code>pref_city.json</code>（上記でダウンロードしたjsonファイル）は設置場所によって、適宜パスを加えてください。</p><p>あとは、基本的に、jsonファイルを読み込んでfor文で回しながらデータを取得し、都道府県や市区町村のoptionを生成しています。</p><p>（※key値と都道府県コードが1ずつずれているため余計な処理が入っているので、ここを調整すればもっとスッキリできると思います。<br>例）北海道：key=0,都道府県コード=01）</p><p>都道府県を切り替えた時に、前に選択していた都道府県の市区町村がフォームに残るので、※1の箇所で1行目（「市区町村を選択してください」などの初期表示行）以外を削除しています。</p><h3><span id="htmlソース">HTMLソース</span></h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"select-pref"</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span>都道府県を選択してください<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"select-city"</span>&gt;</span><span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span>市区町村を選択してください<span class="tag">&lt;/<span class="name">option</span>&gt;</span><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>この「都道府県・市区町村連動フォーム」ってホントよく使いますよね。</p><p>クライアント様やその時々の状況で、バラバラな書き方をしてきましたので、可能な限り統一して簡単に書いていきたいと思う今日このごろです。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/pref-city-form.jpg&quot; alt&gt;&lt;/p&gt;
&lt;div class=&quot;toc-title&quot;&gt;目　次&lt;/div&gt;&lt;div class=&quot;toc&quot;&gt;

&lt;!-- toc --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#基本データ都道
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
    
      <category term="jQuery" scheme="https://lancers.work/tags/jQuery/"/>
    
      <category term="json" scheme="https://lancers.work/tags/json/"/>
    
      <category term="HTML" scheme="https://lancers.work/tags/HTML/"/>
    
  </entry>
  
  <entry>
    <title>Hexo（node.js）で静的ブログを構築してみる</title>
    <link href="https://lancers.work/hexo-nodejs-blog/"/>
    <id>https://lancers.work/hexo-nodejs-blog/</id>
    <published>2019-03-28T20:23:00.000Z</published>
    <updated>2019-04-07T10:18:39.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/hexo-start-nodejs.jpg" alt></p><p>もともとは、超高速WordPress仮想マシン「KUSANAGI」でWEBアプリを量産しようということで、KUSANAGIでブログを書いていました。（今もぼちぼち書いてます）</p><p>なぜ、Node.jsに切り替えたのか？</p><p>それは2018年末にNode.js+Express環境を構築して途中までWEBアプリを作成していたことを思い出し、さらに、2019年初「今年の目標はnode.jsを極める」を目標に掲げていたからです。</p><p>クライアント様の案件はPHPが多くなかなかNode.jsを使う機会がなかったので、年度の切り替えを機にあらためて今年の目標達成に向けて始動したという経緯です。</p><div class="toc-title">目　次</div><div class="toc"><!-- toc --><ul><li><a href="#nodejsインストール">Node.jsインストール</a></li><li><a href="#mongdbインストール">MongDBインストール</a></li><li><a href="#hexoインストール">Hexoインストール</a></li></ul><!-- tocstop --></div><h2><span id="nodejsインストール">Node.jsインストール</span></h2><p>当初、CentOS7ではエラーが出てしまい、時間の無駄と思いubuntuに切り替えたのですが、この度無事このようにKUSANAGIを動かしているCentOS7にNode.jsでのブログ環境を構築できました。</p><p>それではNode.jsのブログ環境を整えていきましょう。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install -y epel-release</span><br><span class="line"></span><br><span class="line">$ sudo yum -y update</span><br><span class="line"></span><br><span class="line">$ sudo yum install -y nodejs</span><br><span class="line"></span><br><span class="line">$ node -v</span><br><span class="line">v6.16.0</span><br><span class="line"></span><br><span class="line">$ npm -v</span><br><span class="line">3.10.10</span><br></pre></td></tr></table></figure><h2><span id="mongdbインストール">MongDBインストール</span></h2><p>前回、ここでハマりました。</p><p>MongoDBをなにげにyumでインストールしましたが、エラーで一向に立ち上がらない。。。</p><p>そして一晩調べた結果、公式通りにやりましたら、なんのなんのすんなりいきました（公式は嘘つかない←当たり前）</p><p>MongoDBの公式ページはこちらです。</p><a href="https://docs.mongodb.com/manual/tutorial/install-mongodb-on-red-hat/" class="link-preview" target="_blank" rel="nofollow"><div class="link-area"><div class="og-image"><img src="http://s3.amazonaws.com/info-mongodb-com/_com_assets/cms/mongodb-for-giant-ideas-bbab5c3cf8.png"></div><div class="descriptions"><div class="og-title">Install MongoDB Community Edition on Red Hat Enterprise or CentOS Linux — MongoDB Manual</div></div></div></a><p>ポイントは<code>/etc/yum.repos.d/mongodb-org-4.0.repo</code>を公式通りに作成または修正することでした。</p><p><code>/etc/yum.repos.d/mongodb-org-4.0.repo</code>を、</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[mongodb-org-4.0]</span><br><span class="line">name=MongoDB Repository</span><br><span class="line">baseurl=https://repo.mongodb.org/yum/redhat/<span class="variable">$releasever</span>/mongodb-org/4.0/x86_64/</span><br><span class="line">gpgcheck=1</span><br><span class="line">enabled=1</span><br><span class="line">gpgkey=https://www.mongodb.org/static/pgp/server-4.0.asc</span><br></pre></td></tr></table></figure><p>と公式ページ記載の通り記述します（上記の内容は執筆時点ですので、インストール時は最新の情報を確認してください。）</p><p>あとはインストールと実行あるのみです！</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install -y mongodb-org</span><br><span class="line"></span><br><span class="line">$ sudo service mongod start</span><br></pre></td></tr></table></figure><p>※MongoDBは開発用にインストールしました。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><h2><span id="hexoインストール">Hexoインストール</span></h2><p>前回のブログでは、Keystoneをインストールしました。</p><p>Keystoneはブログももちろん書けますが、WEBアプリ開発に向いているかなという感じを持ちましたので、ブログはブログに特化したHexoに変更しました。</p><p>Hexoのインストール方法も公式ページに素直に従いましょう。</p><a href="https://hexo.io/" class="link-preview" target="_blank" rel="nofollow"><div class="link-area"><div class="og-image"><img></div><div class="descriptions"><div class="og-title">Hexo</div><div class="og-description">Hexo is a fast, simple &amp; powerful blog framework powered by Node.js.</div></div></div></a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-cli -g</span><br><span class="line"></span><br><span class="line">$ hexo init blog</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> blog</span><br><span class="line"></span><br><span class="line">$ npm install</span><br><span class="line"></span><br><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>「blog」はプロファイル名=ブログを格納する場所です。</p><p><code>hexo server</code>を実行すると、開発環境下では<code>http://ローカルIPアドレス:4000</code>でサイトを見ることができます。</p><p>簡単ですが、Node.jsでブログを開設するところまでの解説でした。</p><p>このあとまだまだ設定したりする箇所もあります。</p><p>目標であるNode.jsアプリの開発もガシガシやっていきたいと思います。</p><p>それらはこちらのブログに随時書いていきたいと思いますのでよろしくお願いします。</p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-6760690047817155" data-ad-slot="5538845879"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/hexo-start-nodejs.jpg&quot; alt&gt;&lt;/p&gt;
&lt;p&gt;もともとは、超高速WordPress仮想マシン「KUSANAGI」でWEBアプリを量産しようということで、KUSANAGIでブログを書いていました。（今もぼちぼち書いて
      
    
    </summary>
    
      <category term="ナレッジ" scheme="https://lancers.work/categories/%E3%83%8A%E3%83%AC%E3%83%83%E3%82%B8/"/>
    
    
      <category term="Node.js" scheme="https://lancers.work/tags/Node-js/"/>
    
      <category term="Hexo" scheme="https://lancers.work/tags/Hexo/"/>
    
      <category term="MongoDB" scheme="https://lancers.work/tags/MongoDB/"/>
    
  </entry>
  
</feed>
